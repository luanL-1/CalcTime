<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calc Time</title>
    <style>
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .item {
            border: 1px solid #ccc;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="item">
            <h1>Calculadora de Diferença de Tempo</h1>
            <form id="diferenca_tempo" method="post">
                <label for="hora_inicio">Hora de início: </label><br>
                <input type="number" id="hora_inicio_horas_dif" name="hora_inicio_horas" min="0" max="23" placeholder="HH" required maxlength="2"> :
                <input type="number" id="hora_inicio_minutos_dif" name="hora_inicio_minutos" min="0" max="59" placeholder="MM" required maxlength="2"><br><br>
                
                <label for="hora_fim">Hora Final: </label><br>
                <input type="number" id="hora_fim_horas_dif" name="hora_fim_horas" min="0" max="23" placeholder="HH" required maxlength="2"> :
                <input type="number" id="hora_fim_minutos_dif" name="hora_fim_minutos" min="0" max="59" placeholder="MM" required maxlength="2"><br><br>
                
                <input type="submit" value="Calcular diferença de tempo">
            </form>
        
            <div id="resultado_dif"></div>
        </div>
        <div class="item">
            <h1>Descontar Horas</h1>
            <form id="diminuir_tempo" method="post">
                <label for="hora_inicio">Hora de início: </label><br>
                <input type="number" id="hora_inicio_horas_des" name="hora_inicio_horas" min="0" max="23" placeholder="HH" required maxlength="2"> :
                <input type="number" id="hora_inicio_minutos_des" name="hora_inicio_minutos" min="0" max="59" placeholder="MM" required maxlength="2"><br><br>
                <label for="minutos">Minutos a diminuir: </label>
                <input type="number" id="minutos_des" name="minutos" required><br><br>
                <input type="submit" value="Diminuir horas">
            </form>
            <div id="resultado_des"></div>
        </div>
    </div>

    <script>
        // Limita o comprimento máximo dos campos de entrada de hora
        var inputsHoras = document.querySelectorAll('input[type="number"]');
        inputsHoras.forEach(function(input) {
            input.addEventListener('input', function() {
                if (this.value.length >= 2) {
                    // Se o campo tiver dois dígitos, mova o foco para o próximo campo de entrada
                    var nextInput = this.nextElementSibling;
                    if (nextInput && nextInput.tagName === 'INPUT') {
                        nextInput.focus();
                    }
                }
            });
        });

        // Corrige a separação ao colar uma hora no formato "HH:MM"
        document.querySelectorAll('input[type="number"]').forEach(function(input) {
            input.addEventListener('paste', function(event) {
                var pasteData = event.clipboardData.getData('text/plain');
                var splitData = pasteData.split(':');
                if (splitData.length === 2 && !isNaN(parseInt(splitData[0])) && !isNaN(parseInt(splitData[1]))) {
                    var hours = parseInt(splitData[0]);
                    var minutes = parseInt(splitData[1]);
                    var nextInput = input.nextElementSibling;
                    if (nextInput && nextInput.tagName === 'INPUT') {
                        input.value = hours.toString().padStart(2, '0');
                        nextInput.value = minutes.toString().padStart(2, '0');
                        nextInput.focus();
                        event.preventDefault();
                    }
                }
            });
        });

        document.getElementById("diferenca_tempo").addEventListener("submit", function(event) {
            event.preventDefault(); // Previne o envio do formulário normalmente
            
            // Obter os valores do formulário
            var horaInicioHoras = parseInt(document.getElementById("hora_inicio_horas_dif").value);
            var horaInicioMinutos = parseInt(document.getElementById("hora_inicio_minutos_dif").value);
            var horaFimHoras = parseInt(document.getElementById("hora_fim_horas_dif").value);
            var horaFimMinutos = parseInt(document.getElementById("hora_fim_minutos_dif").value);
            
            // Calcular a diferença em minutos
            var diferencaMinutos = (horaFimHoras * 60 + horaFimMinutos) - (horaInicioHoras * 60 + horaInicioMinutos);
            
            // Converter a diferença para horas e minutos
            var horas = Math.floor(diferencaMinutos / 60);
            var minutos = diferencaMinutos % 60;
            
            // Exibir o resultado
            document.getElementById("resultado_dif").innerText = "Diferença de tempo: " + horas + " horas e " + minutos + " minutos";
        });

        document.getElementById("diminuir_tempo").addEventListener("submit", function(event) {
            event.preventDefault(); // Previne o envio do formulário normalmente
            
            // Obter os valores do formulário
            var horaInicioHoras = parseInt(document.getElementById("hora_inicio_horas_des").value);
            var horaInicioMinutos = parseInt(document.getElementById("hora_inicio_minutos_des").value);
            var minutos = parseInt(document.getElementById("minutos_des").value);
            
            // Calcular a diferença em minutos
            var diferenca_Minutos = (horaInicioHoras * 60 + horaInicioMinutos) - minutos;
            
            // Converter a diferença para horas e minutos
            var horas = Math.floor(diferenca_Minutos / 60);
            var minutos_restantes = diferenca_Minutos % 60;
            
            // Exibir o resultado
            document.getElementById("resultado_des").innerText = "Resultado: " + horas + " horas e " + minutos_restantes + " minutos.";
        });
    </script>
</body>
</html>
